{% extends "base.html" %}

{% block title %}My Messages{% endblock %}

{% block content %}
    <h1>My Messages</h1>
    <p>Here are all the conversations started by potential buyers.</p>

    <div class="notification-list">
        {% if conversations %}
            {% for conv in conversations %}
                <a href="{{ url_for('dealer.view_conversation', conversation_id=conv.id) }}" class="notification-item-link">
                    <div class="notification-item">
                        <div class="notification-content">
                            <p>
                                Conversation with <strong>{{ conv.buyer.username }}</strong> 
                                about <strong>{{ conv.car.year }} {{ conv.car.make }} {{ conv.car.model }}</strong>
                            </p>
                            <small class="notification-time">
                                Started on: {{ conv.created_at.strftime('%b %d, %Y') }}
                                {% if conv.lead_score %}
                                    <span style="margin-left: 1rem; font-weight: 600;">Lead Score: {{ conv.lead_score.score }}</span>
                                    {% if conv.lead_score.score >= 60 %}<span class="featured-tag" style="background-color: hsl(var(--success)); margin-left: 5px;">Serious Lead</span>{% endif %}
                                {% endif %}
                            </small>
                        </div>
                        <div class="notification-action">
                            <span class="btn">View Chat</span>
                        </div>
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <p>You have no messages from buyers yet.</p>
        {% endif %}
    </div>
{% endblock %}