{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
    <h1>{{ title }}</h1>

    <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="form-grid">
            <div class="form-group">
                {{ form.make.label }}
                {{ form.make() }}
            </div>
            <div class="form-group">
                {{ form.model.label }}
                {{ form.model() }}
            </div>
            <div class="form-group">
                {{ form.year.label }}
                {{ form.year() }}
            </div>
            <div class="form-group">
                {{ form.mileage.label }}
                {{ form.mileage() }}
            </div>
            <div class="form-group">
                {{ form.condition.label }}
                {{ form.condition() }}
            </div>
            <div class="form-group">
                {{ form.body_type.label }}
                {{ form.body_type() }}
            </div>
            <div class="form-group">
                {{ form.transmission.label }}
                {{ form.transmission() }}
            </div>
            <div class="form-group">
                {{ form.drivetrain.label }}
                {{ form.drivetrain() }}
            </div>
            <div class="form-group">
                {{ form.fuel_type.label }}
                {{ form.fuel_type() }}
            </div>
            <div class="form-group full-width">
                {{ form.description.label }}
                {{ form.description(rows=5) }}
            </div>
            <div class="form-group full-width">
                {{ form.images.label }}
                {{ form.images() }}
            </div>
            <div class="form-group full-width">
                {{ form.equipment.label }}
                <div class="checkbox-group">
                    {% for subfield in form.equipment %}
                        <label class="checkbox-label">
                            {{ subfield(class="checkbox-input") }} {{ subfield.label.text }}
                        </label>
                    {% endfor %}
                </div>
            </div>
        </div>

        <hr>
        <h3>Listing Details</h3>
        <div class="form-group">
            {{ form.listing_type.label }}
            <div class="radio-button-group">
                {% for subfield in form.listing_type %}
                    <label class="radio-button-label">
                        {{ subfield(class="radio-button-input") }} {{ subfield.label.text }}
                    </label>
                {% endfor %}
            </div>
        </div>

        {# --- Dynamically Shown Fields --- #}
        <div id="auction-fields" class="listing-type-fields">
            <div class="form-group">{{ form.start_price.label }} {{ form.start_price() }}</div>
            <div class="form-group">{{ form.end_time.label }} {{ form.end_time() }}</div>
        </div>
        <div id="sale-fields" class="listing-type-fields">
            <div class="form-group">{{ form.fixed_price.label }} {{ form.fixed_price() }}</div>
        </div>
        <div id="rental-fields" class="listing-type-fields">
            <div class="form-group">{{ form.price_per_day.label }} {{ form.price_per_day() }}</div>
        </div>

        {{ form.submit(class='btn approve') }}
    </form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const listingTypeRadios = document.querySelectorAll('input[name="listing_type"]');
    const auctionFields = document.getElementById('auction-fields');
    const saleFields = document.getElementById('sale-fields');
    const rentalFields = document.getElementById('rental-fields');

    function toggleFields() {
        const selectedType = document.querySelector('input[name="listing_type"]:checked').value;
        auctionFields.style.display = selectedType === 'auction' ? 'block' : 'none';
        saleFields.style.display = selectedType === 'sale' ? 'block' : 'none';
        rentalFields.style.display = selectedType === 'rental' ? 'block' : 'none';
    }

    listingTypeRadios.forEach(radio => {
        radio.addEventListener('change', toggleFields);
    });

    // Initial check on page load
    toggleFields();
});
</script>

{% endblock %}